<html>
<head>
	<title>CTF match</title>
	<link rel='stylesheet' href='spidertools.css' type='text/css' />
</head>

<body>

<p>
<h2 align="center">CTF match</h2>
<h3 align="center">A tool for analyzing the output from SPIDER's 'TF ED' operation</h3>
</p>

<P><hr /><P>

Wait! First try out <a href="ctfdemo.html">ctfdemo</a>. 
Type "ctfdemo" at the Unix prompt, and experiment with the various CTF parameters used in SPIDER.<br /> 

Did you try that out? Good. Now you're ready for <b>ctfmatch</b>.
<p> 
<a href="#Overview">Overview     </a><br />
<a href="#Command">Command line usage</a><br />
<a href="#Controls">Controls         </a><br />
<a href="#Options">Options           </a><br />
<a href="#Refer">References          </a><br />
</p>

<p>
<center><img src="pics/plot01.gif"> </center>
<p>

<p>
<b>Overview</b><a name="Overview"></a>
<p>

<b>ctfmatch</b> is a program for looking at the output of SPIDER's 
   <a href="../../docs/man/tfed.html">TF ED</a> 
   operation. It displays the 1D spectrum (the CTF), the estimated background, 
   the background-subtracted spectrum, 
   an envelope function, and a model function. 

<p>
You can use <b>ctfmatch</b> to                                
<ul>
  <li> Manually estimate the CTF of a micrograph, just as you use <b>WEB: CTF from doc file</b>, <br />
  <li> Quickly scan through a file series to check if the automatically determined defocus values make sense.
</ul>

<p>
Typical use:                    <br />
<ol>
  <li> On a set of micrographs, generate 2D power spectra with the batch file 
      <a href="../../docs/techs/recon/mr.html#CTF">power.spi</a>.</li>

  <li> Estimate defocus with the 'TF ED' operation via the 
       <a href="../../docs/techs/recon/mr.html#DEF">defocus.spi</a> procedure.
       This outputs a set of doc files with various curves, as well as a doc file 
       containing the defocus estimates.</li>

  <li>
  <dl>
    <dt>Run <b>ctfmatch</b>.</dt>
    <dd> - Set the correct parameters,<br />
         - Read in the set of curve files generated by <a href="../../docs/man/tfed.html">TF ED</a>,<br />
         - Read in the defocus doc file,<br />
         - Select a file to display. Adjust the model parameters if necessary.<br />
         - You can save the new defocus values to a file, if you want.
    </dd>
    </li>
</dl>
</ol>

<b>Command line usage</b><a name="Command"></a>

<p>
Usage: <i>ctfmatch &nbsp;&nbsp; [-keyword value] &nbsp;&nbsp; tfed_file_pattern*</i><br />
where the <i>tfed_files</i> are doc files output from the <a href="../../docs/man/tfed.html">TF ED</a> 
command with 4 columns:<br />
spatial frequency, background, subtracted data, envelope.<br />

<p>The other arguments are (<i>-keyword value</i>) pairs, where the keyword is denoted with a minus sign.</p> 

<p>The following keywords are supported:
<table>
  <tr><td><code> -defocus </code></td><td>defocus doc file with defocus values in column 2</td></tr>
  <tr><td><code> -cs      </code></td><td>(spherical aberration)       </td></tr>
  <tr><td><code> -kev     </code></td><td>(electron energy)            </td></tr>
  <tr><td><code> -pixsize </code></td><td>(Ang./pixel)                 </td></tr>
  <tr><td><code> -src     </code></td><td>(source size)                </td></tr>
  <tr><td><code> -spread  </code></td><td>(defocus spread)             </td></tr>
  <tr><td><code> -acr     </code></td><td>(amplitude contrast ratio)   </td></tr>
  <tr><td><code> -gep     </code></td><td>(Gaussian envelope parameter)</td></tr>
</table>

<p>As soon as an argument is encountered with no preceding keyword, it is assumed that it and all following 
arguments are tfed files. </p>

<p>Examples: <br />
<code>ctfmatch -defocus defocus.dat power/ctf*</code> &nbsp;&nbsp;&nbsp;&nbsp;
      (program will prompt user for parameters)</p>

<p><code>ctfmatch -cs 2.20 -kev 200 -pixsize 2.82</code> &nbsp;&nbsp;&nbsp;&nbsp;
     (user can enter TFED files through "FILE -> Open File series")</p>

<p><code>ctfmatch -pixsize 3.76 ctf0034.dat</code></p>

<p><code>ctfmatch -help </code> <p>

<hr />

<a name="Controls"></a>

<p> <center><img src="pics/slider1.gif"></center> </p>

<p> <b>Controls</b> </p>

<p>There are a number of slider controls that interactively alter parameters 
   in the displayed curves.<p>

<dl>
  <dt><i>Model sliders</i> </dt>  
  <dd>As in ctfdemo, values for defocus, source size, defocus spread, and the 
      Gaussian envelope may be adjusted 
      with the slider controls. Other parameters (pixel size, electron energy, 
      spherical aberration, and amplitude 
      contrast raio) are set in the <i>Options :: Parameters</i> menu. 
      <i>These values only affect the model data (shown in the white curve).</i>
  </dd>

  <p>
  <dt><i>Graph sliders</i></dt>
  <dd> Because of the great dynamic range of the data, the ranges of the graph can be adjusted:<br />
  - ymax : adjusts the maximum value on the vertical axis                                      <br />
  - model height : adjusts the height of the model data                                        <br />
  - xmin : adjusts the left hand side of the graph                                             <br /> 
  - reset ymax button : when xmin of the graph is changed, the data can be rescaled 
    accordingly with this button.
  </dd>
  <p>

  <center> <img src="pics/slider2.gif"> </center>

  <p>
   <dt><i>Show Menu</i> </dt>
   <dd>The <i>Show</i> menu lets you turn the various curves on or off. A curve will 
    be displayed if its box is red 
   (or a checkmark on some systems). As curves are toggled on and off, the 
    maximum height (<i>ymax</i>) of the 
   graph is automatically adjusted to use the entire area for display.
   </dd>
</dl>

   
<center> <img src="pics/menu.gif"> </center>
<br />

<hr />

<p><b>Options</b><a name="Options"></a></p>

<dl>
<dt><u>Parameters</u></dt>
<dd> Lets the user set values for pixel size, electron energy, spherical aberration, 
     and amplitude contrast ratio.</dd>

   <dt><u>Squared data</u></dt>
   <dd> Because the procedure file <a href="../../docs/techs/recon/mr.html#CTF">power_p1.bat</a> takes the 
         \square root of the spectrum, <b>ctfmatch</b> is automatically squares the TF ED data it reads in.  
        This is to ensure that the model parameters are in the same units as the data. Thus by default, the 
        <i>Squared data</i> box is checked. Unchecking this box displays the square root of all the curves 
        (i.e., the unsquared data).
   </dd>

   <dt><u>Grid</u></dt>
   <dd> Toggles a grid on and off.</dd>

   <dt><u>Use empirical envelope</u></dt>
   <dd> Forces the model to fit under the empirically derived envelope (the blue curve). 
        When this option is in effect, various 
        model parameters affecting the envelope, such as source size and defocus spread, 
        are no longer used to compute the 
        displayed model curve.</dd>
</dl>

<p>
<hr />
<p>

<b>References</b><a name="Refer"></a>
<p>
  For details about the <a href="../../docs/man/tfed.html">TF ED</a> operation, see the manual page, and
<p>
 Z. Huang, P.R. Baldwin, and P. A. Penczek. <b>Automated determination of parameters 
 describing power spectra of micrograph 
 images in electron microscopy</b> <i>J. Struct. Biology</i> Vol. 144, Issues 1-2, October 2003, pp. 79-94. 
<p>
<hr />
<p> 

<a href="index.html">Back to index</a>	
</body>
</html>
